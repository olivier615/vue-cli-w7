"use strict";(self["webpackChunkcli_demo"]=self["webpackChunkcli_demo"]||[]).push([[107],{7107:function(t,e,d){d.r(e),d.d(e,{default:function(){return O}});var o=d(3396),a=d(7139);const i={class:"container"},s=(0,o._)("h2",null,"後台-產品列表",-1),n={class:"text-end mt-4"},l={class:"table mt-4"},r=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{width:"120"},"分類"),(0,o._)("th",null,"產品名稱"),(0,o._)("th",{width:"120"},"促銷方式"),(0,o._)("th",{width:"60"},"原價"),(0,o._)("th",{width:"60"},"售價"),(0,o._)("th",{width:"100"},"是否啟用"),(0,o._)("th",{width:"120"},"編輯")])],-1),u={class:"d-flex"},c={class:"text-end"},p={class:"text-end"},h={key:0,class:"text-success"},g={key:1},m={class:"btn-group"},b=(0,o.Uk)(" 編輯 "),_=["onClick"];function w(t,e,d,w,P,v){const k=(0,o.up)("Loading"),y=(0,o.up)("router-link"),f=(0,o.up)("pagination"),$=(0,o.up)("deleteProduct");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",i,[(0,o.Wm)(k,{active:P.isLoading,"z-index":1060},null,8,["active"]),s,(0,o._)("div",n,[(0,o._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>v.openProductPage("new"))}," 建立新的產品 ")]),(0,o._)("table",l,[r,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(P.products,(t=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("td",null,(0,a.zw)(t.category),1),(0,o._)("td",null,(0,a.zw)(t.title),1),(0,o._)("td",null,[(0,o._)("div",u,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.promotion,(e=>((0,o.wg)(),(0,o.iD)("span",{key:e+t.title,class:(0,a.C_)([{"bg-primary":"新品"===e,"bg-danger":"熱門"===e,"bg-success":"特價"===e},"badge rounded-pill me-1"])},(0,a.zw)(e),3)))),128))])]),(0,o._)("td",c,(0,a.zw)(t.origin_price),1),(0,o._)("td",p,(0,a.zw)(t.price),1),(0,o._)("td",null,[t.is_enabled?((0,o.wg)(),(0,o.iD)("span",h,"啟用")):((0,o.wg)(),(0,o.iD)("span",g,"未啟用"))]),(0,o._)("td",null,[(0,o._)("div",m,[(0,o.Wm)(y,{to:`/admin/product/${t.id}`,class:"btn btn-outline-primary btn-sm"},{default:(0,o.w5)((()=>[b])),_:2},1032,["to"]),(0,o._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>v.OpenDeleteProductModal(t)}," 刪除 ",8,_)])])])))),128))])]),(0,o.Wm)(f,{pages:P.pagination,onGetProducts:v.getProducts},null,8,["pages","onGetProducts"])]),(0,o.Wm)($,{"edit-product":P.editProduct,ref:"delProductModal",onUpdate:e[1]||(e[1]=t=>v.getProducts(P.pagination.current_page))},null,8,["edit-product"])],64)}var P=d(1550);const v={id:"delProductModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},k={class:"modal-dialog"},y={class:"modal-content border-0"},f=(0,o._)("div",{class:"modal-header bg-danger text-white"},[(0,o._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,o._)("span",null,"刪除產品")]),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$={class:"modal-body"},x=(0,o.Uk)(" 是否刪除 "),M={class:"text-danger"},D=(0,o.Uk)(" (商品刪除後將無法恢復)。 "),C={class:"modal-footer"},L=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function z(t,e,d,i,s,n){return(0,o.wg)(),(0,o.iD)("div",v,[(0,o._)("div",k,[(0,o._)("div",y,[f,(0,o._)("div",$,[x,(0,o._)("strong",M,(0,a.zw)(d.editProduct.title),1),D]),(0,o._)("div",C,[L,(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>n.deleteProduct&&n.deleteProduct(...t))}," 確認刪除 ")])])])],512)}var U=d(7972),W=d.n(U),H={data(){return{modal:""}},props:["editProduct"],methods:{deleteProduct(){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/product/${this.editProduct.id}`).then((t=>{alert(t.data.message),this.hideModal(),this.$emit("update")})).catch((t=>{alert(t.data.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(W())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},N=d(89);const Y=(0,N.Z)(H,[["render",z]]);var Z=Y,G={components:{pagination:P.Z,deleteProduct:Z},data(){return{isLoading:!1,url:"https://vue3-course-api.hexschool.io/v2",path:"otispath",products:[],editProduct:{imagesUrl:[],promotion:[]},isNew:!1,pagination:{}}},methods:{getProducts(t=1){this.isLoading=!0,this.$http.get(`${this.url}/api/${this.path}/admin/products/?page=${t}`).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.isLoading=!1,alert("無法取得產品列表")}))},openProductPage(t,e){"new"===t?(this.editProduct={imagesUrl:[],promotion:[]},this.isNew=!0,this.$router.push("/admin/product")):"edit"===t&&(this.editProduct={imagesUrl:[],promotion:[]},this.editProduct={...e},this.isNew=!1,this.$router.push("/product/:id"))},OpenDeleteProductModal(t){this.editProduct={...t},this.$refs.delProductModal.openModal()}},mounted(){this.getProducts()}};const K=(0,N.Z)(G,[["render",w]]);var O=K}}]);
//# sourceMappingURL=107.366555ca.js.map