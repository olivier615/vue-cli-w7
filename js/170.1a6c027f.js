"use strict";(self["webpackChunkcli_demo"]=self["webpackChunkcli_demo"]||[]).push([[170],{5170:function(t,e,a){a.r(e),a.d(e,{default:function(){return H}});var l=a(3396),i=a(7139);const n=(0,l._)("h2",null,"後台-文章列表",-1),s={class:"container"},d={class:"text-end mt-4"},o=(0,l.Uk)(" 建立新的文章 "),r={class:"table mt-4"},c=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{width:"120"},"名稱"),(0,l._)("th",{width:"60"},"標籤"),(0,l._)("th",{width:"60"},"作者"),(0,l._)("th",{width:"120"},"建立時間"),(0,l._)("th",{width:"120"},"發布"),(0,l._)("th",{width:"120"},"編輯")])],-1),u={key:0},h={key:1},p={class:"btn-group"},m=(0,l.Uk)(" 編輯 "),g=["onClick"];function b(t,e,a,b,_,w){const v=(0,l.up)("Loading"),k=(0,l.up)("router-link"),A=(0,l.up)("pagination"),f=(0,l.up)("deleteArticle");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(v,{active:_.isLoading,"z-index":1060},null,8,["active"]),n,(0,l._)("div",s,[(0,l._)("div",d,[(0,l.Wm)(k,{class:"btn btn-primary",to:"/admin/article"},{default:(0,l.w5)((()=>[o])),_:1})]),(0,l._)("table",r,[c,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(_.articles,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.title},[(0,l._)("td",null,(0,i.zw)(t.title),1),(0,l._)("td",null,(0,i.zw)(t.tag),1),(0,l._)("td",null,(0,i.zw)(t.author),1),(0,l._)("td",null,(0,i.zw)(new Date(1e3*t.create_at).toLocaleDateString()),1),(0,l._)("td",null,[t.isPublic?((0,l.wg)(),(0,l.iD)("span",u,"啟用中")):((0,l.wg)(),(0,l.iD)("span",h,"未啟用"))]),(0,l._)("td",null,[(0,l._)("div",p,[(0,l.Wm)(k,{to:`/admin/article/${t.id}`,class:"btn btn-outline-primary btn-sm"},{default:(0,l.w5)((()=>[m])),_:2},1032,["to"]),(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>w.OpenDeleteArticleModal(t)}," 刪除 ",8,g)])])])))),128))])]),(0,l.Wm)(A,{pages:_.pagination,onGetProducts:w.getArticles},null,8,["pages","onGetProducts"]),(0,l.Wm)(f,{article:_.article,ref:"delArticleModal",onUpdate:e[0]||(e[0]=t=>w.getArticles(_.pagination.current_page))},null,8,["article"])])],64)}var _=a(1550);const w={id:"delArticleModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delArticleModal","aria-hidden":"true"},v={class:"modal-dialog"},k={class:"modal-content border-0"},A=(0,l._)("div",{class:"modal-header bg-danger text-white"},[(0,l._)("h5",{id:"delArticleModal",class:"modal-title"},[(0,l._)("span",null,"刪除文章")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),f={class:"modal-body"},y={class:"text-center"},M=(0,l._)("strong",{class:"text-danger"},"(刪除文章後將無法恢復)。",-1),D={class:"modal-footer"},x=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function $(t,e,a,n,s,d){return(0,l.wg)(),(0,l.iD)("div",w,[(0,l._)("div",v,[(0,l._)("div",k,[A,(0,l._)("div",f,[(0,l._)("p",y,[(0,l.Uk)(" 確定刪除"+(0,i.zw)(a.article.title)+"？ ",1),M])]),(0,l._)("div",D,[x,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>d.deleteArticle&&d.deleteArticle(...t))}," 確認刪除 ")])])])],512)}var L=a(7972),z=a.n(L),C={data(){return{modal:""}},props:["article"],methods:{deleteArticle(){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/article/${this.article.id}`).then((t=>{alert(t.data.message),this.hideModal(),this.$emit("update")})).catch((t=>{alert(t.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(z())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},W=a(89);const U=(0,W.Z)(C,[["render",$]]);var P=U,Z={components:{pagination:_.Z,deleteArticle:P},data(){return{isLoading:!1,pagination:{},isNew:!1,articles:[],article:{}}},methods:{getArticles(t=1){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/articles/?page=${t}`).then((t=>{console.log(t),this.articles=t.data.articles,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.isLoading=!1,alert("無法取得文章列表")}))},OpenDeleteArticleModal(t){this.article=t,this.$refs.delArticleModal.openModal()}},mounted(){this.getArticles()}};const G=(0,W.Z)(Z,[["render",b]]);var H=G}}]);
//# sourceMappingURL=170.1a6c027f.js.map