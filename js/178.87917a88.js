"use strict";(self["webpackChunkcli_demo"]=self["webpackChunkcli_demo"]||[]).push([[178],{6178:function(e,t,a){a.r(t),a.d(t,{default:function(){return U}});var d=a(3396),l=a(7139);const s=(0,d._)("h2",null,"後台-訂單列表",-1),r={class:"container"},n={class:"table mt-4"},o=(0,d._)("thead",null,[(0,d._)("tr",null,[(0,d._)("th",null,"訂單編號"),(0,d._)("th",null,"訂購者"),(0,d._)("th",null,"金額"),(0,d._)("th",null,"支付狀態"),(0,d._)("th",null,"編輯")])],-1),i={key:0,class:"badge bg-primary"},u={key:1,class:"badge bg-dark"},c={class:"btn-group"},p=(0,d.Uk)(" 編輯訂單 "),h=["onClick"];function g(e,t,a,g,b,m){const _=(0,d.up)("Loading"),v=(0,d.up)("router-link"),w=(0,d.up)("pagination"),k=(0,d.up)("deleteOrder");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d.Wm)(_,{active:b.isLoading,"z-index":1060},null,8,["active"]),s,(0,d._)("div",r,[(0,d._)("table",n,[o,(0,d._)("tbody",null,[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(b.orders,(e=>((0,d.wg)(),(0,d.iD)("tr",{key:e.id},[(0,d._)("td",null,(0,l.zw)(e.id),1),(0,d._)("td",null,(0,l.zw)(e.user.name),1),(0,d._)("td",null,(0,l.zw)(e.total),1),(0,d._)("td",null,[e.is_paid?((0,d.wg)(),(0,d.iD)("span",i,"已支付")):((0,d.wg)(),(0,d.iD)("span",u,"未付款"))]),(0,d._)("td",null,[(0,d._)("div",c,[(0,d.Wm)(v,{class:"btn btn-outline-primary btn-sm",to:`/admin/order/${e.id}`},{default:(0,d.w5)((()=>[p])),_:2},1032,["to"]),(0,d._)("button",{class:"btn btn-danger btn-sm",onClick:t=>m.OpenDeleteOrderModal(e)}," 刪除 ",8,h)])])])))),128))])]),(0,d.Wm)(w,{pages:b.pagination,onGetProducts:m.getOrders},null,8,["pages","onGetProducts"]),(0,d.Wm)(k,{order:b.order,ref:"delOrderModal",onUpdate:t[0]||(t[0]=e=>m.getOrders(b.pagination.current_page))},null,8,["order"])])],64)}var b=a(1550);const m={id:"delOrderModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},_={class:"modal-dialog"},v={class:"modal-content border-0"},w=(0,d._)("div",{class:"modal-header bg-danger text-white"},[(0,d._)("h5",{id:"delOrderModalLabel",class:"modal-title"},[(0,d._)("span",null,"刪除訂單")]),(0,d._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),k={class:"modal-body"},O=(0,d._)("span",null,"支付狀態：",-1),y={key:0,class:"badge bg-primary"},f={key:1,class:"badge bg-dark"},M=(0,d._)("p",{class:"text-center"},[(0,d._)("strong",{class:"text-danger"},"(訂單刪除後將無法恢復)。")],-1),D={class:"modal-footer"},L=(0,d._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function $(e,t,a,s,r,n){return(0,d.wg)(),(0,d.iD)("div",m,[(0,d._)("div",_,[(0,d._)("div",v,[w,(0,d._)("div",k,[(0,d._)("p",null,"訂單編號："+(0,l.zw)(a.order.id),1),(0,d._)("p",null,"訂購者："+(0,l.zw)(a.order.user.name),1),(0,d._)("div",null,[O,a.order.is_paid?((0,d.wg)(),(0,d.iD)("span",y,"已支付")):((0,d.wg)(),(0,d.iD)("span",f,"未付款"))]),M]),(0,d._)("div",D,[L,(0,d._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...e)=>n.deleteOrder&&n.deleteOrder(...e))}," 確認刪除 ")])])])],512)}var x=a(7972),z=a.n(x),C={data(){return{modal:""}},props:["order"],methods:{deleteOrder(){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/order/${this.order.id}`).then((e=>{alert(e.data.message),this.hideModal(),this.$emit("update")})).catch((e=>{alert(e.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(z())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},W=a(89);const P=(0,W.Z)(C,[["render",$]]);var Z=P,G={components:{pagination:b.Z,deleteOrder:Z},data(){return{isLoading:!1,orders:[],pagination:{},order:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getOrders(e=1){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/orders/?page=${e}`).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1})).catch((e=>{console.dir(e),this.isLoading=!1}))},OpenDeleteOrderModal(e){this.order=e,this.$refs.delOrderModal.openModal()}},mounted(){this.getOrders()}};const H=(0,W.Z)(G,[["render",g]]);var U=H}}]);
//# sourceMappingURL=178.87917a88.js.map