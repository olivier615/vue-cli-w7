"use strict";(self["webpackChunkcli_demo"]=self["webpackChunkcli_demo"]||[]).push([[295],{6295:function(t,o,n){n.r(o),n.d(o,{default:function(){return O}});var e=n(3396),a=n(7139);const d=(0,e._)("h2",null,"後台-優惠券列表",-1),l={class:"container"},i={class:"text-end mt-4"},s=(0,e.Uk)(" 建立新的優惠券 "),u={class:"table mt-4"},p=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",{width:"120"},"名稱"),(0,e._)("th",{width:"60"},"啟用"),(0,e._)("th",{width:"60"},"折扣"),(0,e._)("th",{width:"120"},"期限"),(0,e._)("th",{width:"120"},"優惠碼"),(0,e._)("th",{width:"120"},"編輯")])],-1),c={key:0},r={key:1},h={class:"btn-group"},m=(0,e.Uk)(" 編輯 "),b=["onClick"];function _(t,o,n,_,g,w){const C=(0,e.up)("Loading"),v=(0,e.up)("router-link"),k=(0,e.up)("pagination"),f=(0,e.up)("deleteCoupon");return(0,e.wg)(),(0,e.iD)(e.HY,null,[d,(0,e.Wm)(C,{active:g.isLoading,"z-index":1060},null,8,["active"]),(0,e._)("div",l,[(0,e._)("div",i,[(0,e.Wm)(v,{class:"btn btn-primary",to:"/admin/coupon"},{default:(0,e.w5)((()=>[s])),_:1})]),(0,e._)("table",u,[p,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(g.coupons,(t=>((0,e.wg)(),(0,e.iD)("tr",{key:t.id},[(0,e._)("td",null,(0,a.zw)(t.title),1),(0,e._)("td",null,[1===t.is_enabled?((0,e.wg)(),(0,e.iD)("span",c,"啟用中")):((0,e.wg)(),(0,e.iD)("span",r,"未啟用"))]),(0,e._)("td",null,(0,a.zw)(t.percent),1),(0,e._)("td",null,(0,a.zw)(new Date(1e3*t.due_date).toLocaleDateString()),1),(0,e._)("td",null,(0,a.zw)(t.code),1),(0,e._)("td",null,[(0,e._)("div",h,[(0,e.Wm)(v,{to:`/admin/coupon/${t.id}`,class:"btn btn-outline-primary btn-sm"},{default:(0,e.w5)((()=>[m])),_:2},1032,["to"]),(0,e._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>w.OpenDeleteCouponModal(t)}," 刪除 ",8,b)])])])))),128))])]),(0,e.Wm)(k,{pages:g.pagination,onGetProducts:w.getCoupons},null,8,["pages","onGetProducts"])]),(0,e.Wm)(f,{coupon:g.coupon,ref:"delCouponModal",onUpdate:o[0]||(o[0]=t=>w.getCoupons(g.pagination.current_page))},null,8,["coupon"])],64)}var g=n(1550);const w={id:"delCouponModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},C={class:"modal-dialog"},v={class:"modal-content border-0"},k=(0,e._)("div",{class:"modal-header bg-danger text-white"},[(0,e._)("h5",{id:"delCouponModal",class:"modal-title"},[(0,e._)("span",null,"刪除優惠券")]),(0,e._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),f={class:"modal-body"},y={class:"text-center"},M=(0,e._)("strong",{class:"text-danger"},"(刪除優惠券後將無法恢復)。",-1),D={class:"modal-footer"},x=(0,e._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function L(t,o,n,d,l,i){return(0,e.wg)(),(0,e.iD)("div",w,[(0,e._)("div",C,[(0,e._)("div",v,[k,(0,e._)("div",f,[(0,e._)("p",y,[(0,e.Uk)(" 確定刪除"+(0,a.zw)(n.coupon.title)+"？ ",1),M])]),(0,e._)("div",D,[x,(0,e._)("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(...t)=>i.deleteCoupon&&i.deleteCoupon(...t))}," 確認刪除 ")])])])],512)}var $=n(7972),z=n.n($),W={data(){return{modal:""}},props:["coupon"],methods:{deleteCoupon(){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/coupon/${this.coupon.id}`).then((t=>{alert(t.data.message),this.hideModal(),this.$emit("update")})).catch((t=>{alert(t.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(z())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},U=n(89);const P=(0,U.Z)(W,[["render",L]]);var Z=P,G={components:{pagination:g.Z,deleteCoupon:Z},data(){return{isLoading:!1,pagination:{},isNew:!1,coupons:[],coupon:{}}},methods:{getCoupons(t=1){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/coupons/?page=${t}`).then((t=>{this.coupons=t.data.coupons,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.isLoading=!1,alert("無法取得優惠券列表")}))},OpenDeleteCouponModal(t){this.coupon=t,this.$refs.delCouponModal.openModal()}},mounted(){this.getCoupons()}};const H=(0,U.Z)(G,[["render",_]]);var O=H}}]);
//# sourceMappingURL=295.a25149ee.js.map