"use strict";(self["webpackChunkcli_demo"]=self["webpackChunkcli_demo"]||[]).push([[449],{1449:function(e,o,t){t.r(o),t.d(o,{default:function(){return B}});var n=t(3396),s=t(9242);const a=(0,n._)("h2",null,"新增/編輯優惠券",-1),i={class:"container"},c={class:"row"},l={class:"bg-dark text-white p-2 mb-3"},d={class:"modal-title"},u={key:0},p={key:1},h={class:"mb-3"},r=(0,n._)("label",{for:"couponName",class:"form-label"},"優惠券名稱",-1),m={class:"mb-3"},_=(0,n._)("label",{for:"couponPercent",class:"form-label"},"優惠券折扣",-1),b={class:"mb-3"},g=(0,n._)("label",{for:"couponCode",class:"form-label"},"優惠券折扣碼",-1),f={class:"mb-3"},v=(0,n._)("label",{for:"due_date",class:"form-label"},"優惠券期限",-1),w={class:"mb-3 form-check"},k=["checked"],y=(0,n._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),$={class:"text-end"},L=(0,n.Uk)("取消"),x=(0,n._)("button",{type:"submit",class:"btn btn-primary"},"確認",-1);function C(e,o,t,C,N,D){const U=(0,n.up)("Loading"),B=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(U,{active:N.isLoading,"z-index":1060},null,8,["active"]),a,(0,n._)("div",i,[(0,n._)("div",c,[(0,n._)("div",l,[(0,n._)("h5",d,[N.isNew?((0,n.wg)(),(0,n.iD)("span",u,"新增產品")):((0,n.wg)(),(0,n.iD)("span",p,"編輯產品"))])]),(0,n._)("form",{onSubmit:o[5]||(o[5]=(0,s.iM)(((...e)=>D.updateCoupon&&D.updateCoupon(...e)),["prevent"]))},[(0,n._)("div",h,[r,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>N.coupon.title=e),type:"text",class:"form-control",id:"couponName"},null,512),[[s.nr,N.coupon.title]])]),(0,n._)("div",m,[_,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>N.coupon.percent=e),type:"number",class:"form-control",id:"couponPercent"},null,512),[[s.nr,N.coupon.percent]])]),(0,n._)("div",b,[g,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>N.coupon.code=e),type:"text",class:"form-control",id:"couponCode"},null,512),[[s.nr,N.coupon.code]])]),(0,n._)("div",f,[v,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>N.date=e),type:"date",class:"form-control",id:"due_date"},null,512),[[s.nr,N.date]])]),(0,n._)("div",w,[(0,n.wy)((0,n._)("input",{type:"checkbox",class:"form-check-input",checked:N.coupon.is_enabled,"onUpdate:modelValue":o[4]||(o[4]=e=>N.changeBoolean=e),id:"is_enabled"},null,8,k),[[s.e8,N.changeBoolean]]),y]),(0,n._)("div",$,[(0,n.Wm)(B,{class:"btn btn-outline-secondary me-2",to:"/admin/coupons"},{default:(0,n.w5)((()=>[L])),_:1}),x])],32)])])],64)}var N={data(){return{isLoading:!1,isNew:!1,date:"",changeBoolean:!1,coupon:{title:"",is_enabled:0,percent:0,due_date:0,code:""}}},watch:{changeBoolean(){this.changeBoolean?this.coupon.is_enabled=1:this.coupon.is_enabled=0},date(){this.coupon.due_date=new Date(this.date).getTime()/1e3}},methods:{updateCoupon(){if(this.isLoading=!0,this.isNew)this.$http.post("https://vue3-course-api.hexschool.io/v2/api/otispath/admin/coupon",{data:this.coupon}).then((e=>{alert("優惠券已新增"),this.isLoading=!1,this.$router.push("/admin/coupons")})).catch((e=>{console.log(e.message),this.isLoading=!1}));else{const{id:e}=this.$route.params;this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/coupon/${e}`,{data:this.coupon}).then((e=>{alert("優惠券已更新"),this.isLoading=!1,this.$router.push("/admin/coupons")})).catch((e=>{console.log(e.message),this.isLoading=!1}))}},getCoupon(){this.isLoading=!0;const{id:e}=this.$route.params;void 0===e?(this.isNew=!0,this.isLoading=!1):(this.isNew=!1,this.$http.get("https://vue3-course-api.hexschool.io/v2/api/otispath/admin/coupons").then((o=>{const t=o.data.coupons.filter((o=>o.id===e));this.coupon=t[0];const n=new Date(1e3*this.coupon.due_date),s=n.getFullYear();let a=n.getMonth()+1,i=n.getDate();a<10&&(a=`0${a}`),i<10&&(i=`0${i}`),this.date=`${s}-${a}-${i}`,this.isLoading=!1})).catch((()=>{console.log("無法取得優惠券資料"),this.isLoading=!1})))}},mounted(){this.getCoupon()}},D=t(89);const U=(0,D.Z)(N,[["render",C]]);var B=U}}]);
//# sourceMappingURL=449.402f2043.js.map